--- 
- name: "update apt packages"
  become: true
  become_method: sudo
  apt:
    update_cache: yes

- name: "remove deps that are no longer needed"
  become: true
  apt: 
    autoremove: yes

- name: Install Dependencies
  become: true
  apt:
    name: ["nodejs", "npm"]
    state: latest
    update_cache: yes

- name: Install pm2
  become: true
  npm:
    name: "pm2"
    global: yes
    production: yes
    state: present

# - name: Create directory
#   file:
#     path: ~/web
#     state: directory

# - name: Copy index test page
#   copy:
#     src: index.js
#     dest: ~/web/index.js

# - name: Start Node project
#   shell: |
#     pm2 start ~/web/index.js -f